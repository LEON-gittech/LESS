WARNING 07-23 16:51:22 _custom_ops.py:14] Failed to import from vllm._C with ImportError("/lib/x86_64-linux-gnu/libc.so.6: version `GLIBC_2.32' not found (required by /home/tiger/.local/lib/python3.9/site-packages/vllm/_C.abi3.so)")
[2024-07-23 16:51:24,291] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
Unused kwargs: ['_load_in_4bit', '_load_in_8bit', 'quant_method']. These kwargs are not used in <class 'transformers.utils.quantization_config.BitsAndBytesConfig'>.
/home/tiger/.local/lib/python3.9/site-packages/peft/tuners/lora/bnb.py:325: UserWarning: Merge lora module to 4-bit linear may get different generations due to rounding errors.
  warnings.warn(
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m using untested triton version (2.3.0), only 1.0.0 is known to be compatible
Loading data...
Loading model and tokenizer...
True
loaded the peft model
Convert model to bfloat16 precision.
Generating Completions:   0%|          | 0/200 [00:00<?, ?it/s]/home/tiger/.local/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:540: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/tiger/.local/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:545: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:   0%|          | 1/200 [00:23<1:19:29, 23.97s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:   1%|          | 2/200 [00:46<1:17:12, 23.40s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:   2%|▏         | 3/200 [01:09<1:15:57, 23.13s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:   2%|▏         | 4/200 [01:33<1:16:31, 23.43s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:   2%|▎         | 5/200 [01:56<1:15:38, 23.28s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:   3%|▎         | 6/200 [02:19<1:14:56, 23.18s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:   4%|▎         | 7/200 [02:43<1:14:50, 23.27s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:   4%|▍         | 8/200 [03:06<1:14:19, 23.23s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:   4%|▍         | 9/200 [03:29<1:13:52, 23.21s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:   5%|▌         | 10/200 [03:52<1:13:49, 23.31s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:   6%|▌         | 11/200 [04:15<1:13:09, 23.23s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:   6%|▌         | 12/200 [04:39<1:12:40, 23.20s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:   6%|▋         | 13/200 [05:02<1:12:18, 23.20s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:   7%|▋         | 14/200 [05:25<1:11:51, 23.18s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:   8%|▊         | 15/200 [05:48<1:11:43, 23.26s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:   8%|▊         | 16/200 [06:12<1:11:18, 23.25s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:   8%|▊         | 17/200 [06:35<1:10:50, 23.23s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:   9%|▉         | 18/200 [06:58<1:10:16, 23.17s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  10%|▉         | 19/200 [07:21<1:09:54, 23.18s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  10%|█         | 20/200 [07:44<1:09:41, 23.23s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  10%|█         | 21/200 [08:07<1:09:09, 23.18s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  11%|█         | 22/200 [08:31<1:08:58, 23.25s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  12%|█▏        | 23/200 [08:54<1:08:51, 23.34s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  12%|█▏        | 24/200 [09:18<1:08:17, 23.28s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  12%|█▎        | 25/200 [09:41<1:07:57, 23.30s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  13%|█▎        | 26/200 [10:04<1:07:28, 23.27s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  14%|█▎        | 27/200 [10:27<1:06:44, 23.15s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  14%|█▍        | 28/200 [10:50<1:06:39, 23.26s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  14%|█▍        | 29/200 [10:54<49:08, 17.24s/it]  Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  15%|█▌        | 30/200 [11:17<54:02, 19.07s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  16%|█▌        | 31/200 [11:41<57:54, 20.56s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  16%|█▌        | 32/200 [12:04<59:38, 21.30s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  16%|█▋        | 33/200 [12:27<1:00:47, 21.84s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  17%|█▋        | 34/200 [12:51<1:02:00, 22.41s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  18%|█▊        | 35/200 [13:14<1:02:12, 22.62s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  18%|█▊        | 36/200 [13:37<1:02:28, 22.86s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  18%|█▊        | 37/200 [14:02<1:03:05, 23.22s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  19%|█▉        | 38/200 [14:25<1:03:03, 23.36s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  20%|█▉        | 39/200 [14:49<1:02:55, 23.45s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  20%|██        | 40/200 [15:13<1:02:42, 23.51s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  20%|██        | 41/200 [15:36<1:02:21, 23.53s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  21%|██        | 42/200 [16:00<1:01:56, 23.52s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  22%|██▏       | 43/200 [16:23<1:01:22, 23.46s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  22%|██▏       | 44/200 [16:47<1:01:06, 23.50s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  22%|██▎       | 45/200 [17:10<1:00:40, 23.49s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  23%|██▎       | 46/200 [17:34<1:00:28, 23.56s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  24%|██▎       | 47/200 [17:57<1:00:06, 23.57s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  24%|██▍       | 48/200 [18:21<59:51, 23.63s/it]  Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  24%|██▍       | 49/200 [18:45<59:29, 23.64s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  25%|██▌       | 50/200 [19:08<59:04, 23.63s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  26%|██▌       | 51/200 [19:32<58:32, 23.57s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  26%|██▌       | 52/200 [19:55<58:13, 23.61s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  26%|██▋       | 53/200 [20:19<58:03, 23.69s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  27%|██▋       | 54/200 [20:43<57:23, 23.59s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  28%|██▊       | 55/200 [21:07<57:09, 23.65s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  28%|██▊       | 56/200 [21:31<57:03, 23.78s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  28%|██▊       | 57/200 [21:58<59:34, 25.00s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  29%|██▉       | 58/200 [22:30<1:03:35, 26.87s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  30%|██▉       | 59/200 [23:06<1:09:57, 29.77s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  30%|███       | 60/200 [23:41<1:13:18, 31.42s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  30%|███       | 61/200 [24:13<1:13:10, 31.59s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  31%|███       | 62/200 [24:38<1:07:28, 29.33s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  32%|███▏      | 63/200 [25:02<1:03:33, 27.84s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  32%|███▏      | 64/200 [25:28<1:01:47, 27.26s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  32%|███▎      | 65/200 [25:52<59:29, 26.44s/it]  Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  33%|███▎      | 66/200 [26:18<58:20, 26.12s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  34%|███▎      | 67/200 [26:47<59:56, 27.04s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  34%|███▍      | 68/200 [28:15<1:39:41, 45.31s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  34%|███▍      | 69/200 [28:41<1:26:13, 39.49s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  35%|███▌      | 70/200 [29:04<1:15:18, 34.76s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  36%|███▌      | 71/200 [29:29<1:08:02, 31.65s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  36%|███▌      | 72/200 [29:53<1:03:02, 29.55s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  36%|███▋      | 73/200 [30:19<1:00:02, 28.37s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  37%|███▋      | 74/200 [30:44<57:37, 27.44s/it]  Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  38%|███▊      | 75/200 [31:09<55:23, 26.59s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  38%|███▊      | 76/200 [31:34<53:46, 26.02s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  38%|███▊      | 77/200 [31:58<52:25, 25.57s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  39%|███▉      | 78/200 [32:23<51:31, 25.34s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  40%|███▉      | 79/200 [32:47<50:19, 24.95s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Generating Completions:  40%|████      | 80/200 [33:21<55:09, 27.58s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
